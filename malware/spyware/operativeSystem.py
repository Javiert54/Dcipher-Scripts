import win32com.client
import psutil
import os


# Iterar y mostrar los resultados
def getApps(file:str = 'files_exploits.csv'):

    # Obtener el objeto WMI
    wmi = win32com.client.GetObject("winmgmts:")
    # Crear una instancia para consultar las aplicaciones instaladas
    return wmi.ExecQuery("SELECT * FROM Win32_Product")

def getUsers():
    return set(os.listdir('C:\\Users'))

#print(getUsers())
#print([(app.Name, app.Version) for app in getApps()])